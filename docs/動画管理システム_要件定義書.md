# 動画管理システム 要件定義書

作成日: 2026年1月1日

---

## 1. プロジェクト概要

### 1.1 背景・目的

PCのCドライブおよび外付けHDDに保存している約2000ファイルの動画を、より効果的に活用できるようにするためのシステムを構築する。現状では動画ファイルの整理が部分的にとどまっており、お気に入りの動画を気分に合わせて視聴する際の利便性に課題がある。

本プロジェクトの主な目的は以下の通り：

- お気に入りの動画を「テンションが上がるように」効率的にアクセスできるようにする
- 視聴履歴を自動的に記録し、データに基づいた動画選択を支援する
- 段階的に機能拡張できる柔軟なシステムを構築する
- 技術的なスキルアップの機会とする（特にWeb技術領域）

### 1.2 現状の課題

現在の動画ファイル管理における課題は以下の点である：

- **整理の不統一性**: 古いファイルは登場人物ごとにフォルダ分けされているが、新しいファイルはまだ未整理である
- **お気に入り管理の限界**: ファイル名の先頭に`###_`、`##_`、`#_`、`_`という規則性を持たせることで優先度を示しているものの、この情報を活用した動画選択の仕組みがない
- **視聴履歴の不在**: どの動画をよく見ているか、最近見ていない動画は何かといった情報が把握できていない
- **気分に合わせた選択の困難さ**: 2000ファイルの中から、その時の気分や状況に合わせた動画を見つけることが難しい

### 1.3 期待される効果

本システムの導入により、以下の効果を期待する：

- お気に入り度や登場人物などの条件でフィルタリングし、視聴したい動画へ素早くアクセスできる
- ランダム再生機能により、お気に入り動画の中から意外な選択を楽しめる
- 視聴履歴の自動記録により、自分の視聴傾向を客観的に把握できる
- 「よく見るけど最近見ていない動画」などの推薦機能により、埋もれた名作を再発見できる
- 将来的な機能拡張（気分タグ、統計分析など）への道筋をつける

---

## 2. 要件定義

### 2.1 動画ファイルの現状

#### 2.1.1 ファイル規模
- 総数: 約2000ファイル
- 保存場所: PCのCドライブ + 外付けHDD
- 運用方針: お気に入り上位（`###`、`##`）のファイルはCドライブに配置、それ以外は外付けHDDに保管

#### 2.1.2 既存の整理ルール
**ファイル名の命名規則**：ファイル名の先頭にお気に入り度を示す記号を付与している
- `###_*`: 最もお気に入り（レベル3）
- `##_*`: お気に入り（レベル2）
- `#_*`: やや気に入っている（レベル1）
- `_*`: 通常（レベル0）

※ `*` の部分には作品タイトルが記載される

**フォルダ構成**：古いファイルは登場人物ごとにフォルダ分けされている。新しいファイルはフォルダ分けが未完了の状態である。

### 2.2 機能要件

#### 2.2.1 最優先機能（フェーズ1で実装）

**データベース管理**
- 動画ファイルの情報（ファイルパス、ファイル名、お気に入り度、登場人物、保存場所など）をSQLiteデータベースで管理する
- ファイル名から自動的にお気に入り度を抽出・記録する
- フォルダ名から登場人物情報を抽出・記録する
- Cドライブと外付けHDD両方のファイルをスキャンし、データベースに登録できる

**フィルタ・検索機能**
- 登場人物での絞り込み
- お気に入りレベルでの絞り込み（`###`、`##`、`#`などの複数選択可）
- 保存場所（Cドライブ/外付けHDD）での絞り込み

**動画一覧表示**
- フィルタ条件に合致する動画をビジュアルに一覧表示する
- 一覧からは少なくともファイル名、お気に入り度、登場人物、視聴回数などの基本情報を確認できる

**ランダム再生機能**
- フィルタ条件に合致する動画の中からランダムに1本を選択し、再生する
- 特にお気に入り上位（`###`、`##`）でのランダム再生を想定

**視聴履歴の自動記録**
- 動画を再生した際に、視聴日時を自動的にデータベースに記録する
- ユーザーが手動で記録する必要はない

**基本統計表示**
- 視聴回数のランキング表示
- 「よく見るけど最近見ていない動画」のリスト表示（例：視聴回数5回以上で30日以上未視聴）

#### 2.2.2 将来的な拡張機能（フェーズ2以降で検討）

**気分トラッキング機能**
- 動画視聴後に簡単な気分タグ（「元気が出た」「癒された」など）を記録できる
- 気分タグ別の視聴ランキングや傾向分析

**統計ダッシュボード**
- 月別の視聴時間
- お気に入り度別の視聴分布
- pandas/seabornを活用したデータ分析と可視化

**その他の拡張案**
- 時間帯・曜日の視聴傾向分析
- 連続視聴パターンの検出
- サムネイル自動抽出
- プレイリスト機能

### 2.3 非機能要件

#### 2.3.1 セキュリティ・プライバシー
- **完全ローカル動作**: ファイル名称や視聴ログデータなどの一切の情報をネットワークに送信しない
- すべてのデータ処理は固定PCのみで完結する
- データベースファイルもローカルに保存する

#### 2.3.2 運用性
- **再生環境**: 同じPCで再生する
- **外付けHDDの接続**: 外付けHDDはたまに接続する運用とする。接続時には新規ファイルをスキャンし、データベースに追加できること
- **起動の容易さ**: バッチファイルやショートカットから簡単に起動できること

#### 2.3.3 拡張性
- 将来的な機能追加を見据えた設計とする
- 特に、Streamlitから Flask/FastAPI + HTML/JS への移行を想定し、コアロジック（データベース操作、ビジネスロジック）は再利用可能な形で実装する
- データベーススキーマは将来の拡張を考慮した設計とする

#### 2.3.4 ユーザビリティ
- **GUIの提供**: ビジュアルに一覧を見ながら選択できるGUIを提供する（コマンドラインではなく）
- **直感的な操作**: 技術的な知識がなくても使える直感的なインターフェース
- **レスポンス**: フィルタ適用や一覧表示は快適な速度で動作すること（2000ファイル程度であれば問題ないと想定）

---

## 3. 技術選定

### 3.1 選定プロセス

技術選定においては、以下の要素を総合的に考慮した：

1. **機能要件の実現可能性**: 要求される機能を実装できるか
2. **スキル習得の価値**: 今後のキャリアやDXリーダーとしての活動に活かせるか
3. **使い勝手**: 日常的に使うツールとして快適か
4. **拡張性**: 将来的な機能追加に対応できるか
5. **段階的アプローチ**: まず動くものを作り、段階的に改善できるか

### 3.2 検討した選択肢

以下の3つの技術スタックを比較検討した。

#### 3.2.1 Python + Streamlit
**概要**: データサイエンス向けの軽量Webフレームワーク

**メリット**
- pandas/seabornとの親和性が高く、統計分析・可視化が容易
- UIコンポーネントが豊富で、少ないコード量で実装できる
- データ分析者向けのモダンなツールであり、学習価値がある
- 完全にローカルで動作（`localhost`でアクセス）

**デメリット**
- 毎回起動が必要（常駐には向かない）
- 画面の状態保持がやや特殊（リロードで初期化されることがある）
- レイアウトの自由度は中程度

**学習価値**: ★★★☆☆（データアプリ開発の新しいアプローチ、リアクティブプログラミング）

#### 3.2.2 Python + Flask/FastAPI + HTML/JS
**概要**: Webアプリケーションのバックエンドとフロントエンドを分離した構成

**メリット**
- サーバーを常駐させることができ、ブラウザから即座にアクセス可能
- RESTful API設計を学べる
- HTML/CSS/JavaScriptの基礎を習得できる
- レイアウトの自由度が高く、柔軟なUI設計が可能
- 将来の拡張性が最も高い（API化により他システムとの連携も可能）
- DX推進者としてのスキルセットが大きく広がる

**デメリット**
- 初期の学習コストが高い
- HTML/JSも書く必要があり、習得する技術範囲が広い

**学習価値**: ★★★★★（Webアプリケーション全般の基礎、API設計、フロント/バックエンド分離の思想）

#### 3.2.3 Python + Tkinter/PyQt
**概要**: デスクトップGUIアプリケーション

**メリット**
- Pythonで完結し、既存のPythonスキルをそのまま活用できる
- OSネイティブな操作感
- .exe化すればPython環境不要で配布可能
- VBAのフォーム開発経験を活かせる

**デメリット**
- UIデザインが古臭くなりがち
- グラフ表示などは別途ライブラリが必要
- 新しい学びが少ない

**学習価値**: ★★☆☆☆（GUIプログラミングの基礎、イベント駆動型プログラミング）

### 3.3 採用技術

#### 3.3.1 フェーズ1: Streamlit
**理由**: 「まず動くものを優先する」という方針に基づき、**Python + Streamlit** を採用する。

Streamlitを選択した主な理由は以下の通り：

- **迅速な開発**: 少ないコード量で実装でき、早期に動作するプロトタイプを作成できる
- **分析機能との相性**: 視聴履歴の統計分析やグラフ表示がpandas/seabornと連携して容易に実装できる
- **学習価値**: データアプリ開発という新しい領域の知識を得られる
- **ローカル完結**: `localhost`での動作により、セキュリティ要件を満たす

ただし、Streamlitには以下の制約があることも認識している：

- 常駐させにくい
- 画面遷移や状態管理に癖がある
- レイアウトの自由度が限定的

これらの制約は、フェーズ1の最小機能を実現する上では許容範囲内であると判断した。

#### 3.3.2 将来の移行先: Flask/FastAPI + HTML/JS
**理由**: 将来的により高度な機能や使い勝手を追求する際には、**Flask/FastAPI + HTML/JS** への移行を見据える。

移行を見据える主な理由は以下の通り：

- **常駐可能**: サーバーを常駐させ、ブラウザからいつでもアクセスできる
- **拡張性**: 機能追加やUI改善の自由度が高い
- **学習価値の最大化**: Web技術全般を体系的に学べ、DXリーダーとしてのスキルセットが大幅に拡張される
- **他システムとの連携**: API化により、将来的に他のツールやサービスとの連携も視野に入る

#### 3.3.3 移行戦略
フェーズ1の実装においては、将来のFlask移行を見据えた**レイヤー分離設計**を採用する。

具体的には、以下のようにモジュールを分離する：

- **コア層（Flask移行時も再利用）**
  - `core/database.py`: SQLite操作（CRUD）
  - `core/video_manager.py`: ビジネスロジック（フィルタリング、ランダム選択、再生など）
  - `core/models.py`: データ構造定義
  - `config.py`: 設定管理

- **UI層（Streamlit固有、移行時は削除）**
  - `streamlit_app.py`: Streamlit UI

この設計により、Flask移行時にはUI層のみを書き換え、コア層はそのまま再利用できる。これにより、段階的な移行が可能となり、開発投資を無駄にしない。

### 3.4 データベース

**採用技術**: SQLite

**理由**:
- 軽量でセットアップ不要（ファイルベースのデータベース）
- Pythonの標準ライブラリでサポートされている
- 2000ファイル程度の規模であれば十分な性能
- 完全にローカルで動作し、セキュリティ要件を満たす
- 将来的にPostgreSQLなどへの移行も可能（SQL互換性）

### 3.5 その他のツール・ライブラリ

- **pandas**: データ操作、統計分析
- **Python標準ライブラリ**: ファイル操作（`os`, `pathlib`）、動画再生（`subprocess`でデフォルトプレイヤー起動）
- **将来的な拡張**:
  - サムネイル抽出: `opencv-python`, `ffmpeg`
  - グラフ描画: `matplotlib`, `seaborn`

---

## 4. まとめ

本プロジェクトは、約2000本の動画ファイルを効率的に管理・活用するためのシステムを構築するものである。「まず動くものを優先する」という現実的なアプローチを採りつつ、将来的な拡張性を考慮した設計を行う。

フェーズ1ではStreamlitを用いて基本機能（フィルタ、ランダム再生、視聴履歴記録、基本統計）を実装し、日常的に使えるツールとして完成させる。その過程で得られた知見や要望をもとに、フェーズ2以降でFlask/FastAPIへの移行や高度な分析機能の追加を検討する。

この段階的アプローチにより、技術的なリスクを抑えながら、スキルアップと実用性の両立を図る。
